# IMPORTANT INFO:
# MORE STUFF LIKE SETTING X-UA-COMPATIBLE HEADER IS DONE IN FUNCTION_REX_CLIENT_CACHE.INC.PHP

# PREVENT DIRECTORY LISTING
Options -Indexes

# ADDITIONAL FILETYPES
AddType video/ogg .ogv
AddType video/mp4 .mp4
AddType video/webm .webm
AddType x-font/eot .eot
AddType x-font/ttf .ttf
AddType x-font/svg .svg
AddType x-font/woff .woff

# COMPRESS FILES
<IfModule mod_deflate.c>
	AddOutputFilterByType DEFLATE text/html text/xml text/css text/plain
	AddOutputFilterByType DEFLATE text/javascript application/javascript application/x-javascript
	AddOutputFilterByType DEFLATE x-font/eot x-font/ttf x-font/svg
</IfModule>

# EXPIRE HEADERS
<IfModule mod_expires.c>
	ExpiresActive On
	ExpiresDefault "access plus 1 week"
	ExpiresByType text/html "access plus 1 minute"
	ExpiresByType text/plain "access plus 1 minute"
	ExpiresByType application/xml "access plus 1 minute"
	ExpiresByType text/css "access plus 4 weeks"
	ExpiresByType text/javascript "access plus 4 weeks"
	ExpiresByType image/gif "access plus 1 week"
	ExpiresByType image/png "access plus 1 week"
	ExpiresByType image/jpg "access plus 1 week"
	ExpiresByType image/jpeg "access plus 1 week"
	ExpiresByType image/x-icon "access plus 1 week"
	ExpiresByType x-font/eot "access plus 4 weeks"
	ExpiresByType x-font/svg "access plus 4 weeks"
	ExpiresByType x-font/ttf "access plus 4 weeks"
	ExpiresByType x-font/woff "access plus 4 weeks"
	ExpiresByType audio/mpeg "access plus 4 weeks"
	ExpiresByType video/mp4 "access plus 4 weeks"
	ExpiresByType application/javascript "access plus 4 weeks"
	ExpiresByType application/x-javascript "access plus 4 weeks"
	ExpiresByType application/x-shockwave-flash "access plus 4 weeks"
</IfModule>

# CACHE CONTROL HEADERS
<IfModule mod_headers.c>
	<FilesMatch "\\.(jpg|png|gif|ico)$">
		Header set Cache-Control "max-age=604800, public"
	</FilesMatch>
	<FilesMatch "\\.(eot|svg|ttf|woff|swf|mp3|mp4)$">
		Header set Cache-Control "max-age=2419200, public"
	</FilesMatch>
	<FilesMatch "\\.(css|js)$">
		Header set Cache-Control "max-age=2419200, private"
	</FilesMatch>
</IfModule>

# TURN ETAGS OFF
<IfModule mod_headers.c>
	Header unset ETag 
</IfModule>

FileETag None

# FORCE DOWNLOAD
<FilesMatch "\.(pdf|mp3|mp4)$">
	ForceType application/octet-stream
	Header set Content-Disposition attachment
</FilesMatch>

<IfModule mod_rewrite.c>
	# ENABLE REWRITING
	RewriteEngine On
	RewriteBase /

	# REDIRECT NON-WWW TO WWW
	#RewriteCond %{HTTP_HOST} !^www\. [NC]
	#RewriteRule (.*) http://www.%{HTTP_HOST}/$1 [R=301,L]

	# REDIRECT SITEMAP.XML TO REXSEO SITEMAP FUNCTION
	RewriteRule ^sitemap\.xml$ index.php?rexseo_func=sitemap [NC,L]

	# REDIRECT ROBOTS.TXT TO REXSEO ROBOTS FUNCTION
	RewriteRule ^robots\.txt$ index.php?rexseo_func=robots [NC,L]

	# REWRITE RULE FOR SEO FRIENDLY IMAGE MANAGER URLS
	RewriteRule ^files[0-9]?/imagetypes/([^/]*)/([^/]*) index.php?rex_img_type=$1&rex_img_file=$2

	# REWRITE RULE FOR AUTOMATIC JS/CSS VERSIONING
	RewriteRule ^(.*)\.[\d]+\.(css|js)$ $1.$2 [L]

	# DON'T REWRITE IF REAL FILE, FOLDER OR SYMLINK EXISTS
	RewriteCond %{REQUEST_FILENAME} !-f
	RewriteCond %{REQUEST_FILENAME} !-d
	RewriteCond %{REQUEST_FILENAME} !-l

	# EXCLUDE SPECIFIC FOLDERS FROM REWRITE ENGINE
	RewriteCond %{REQUEST_URI} !/files[0-9]?/
	RewriteCond %{REQUEST_URI} !/redaxo/
	RewriteCond %{REQUEST_URI} !/layout/

	# REWRITE ALL OTHER REQUESTS TO INDEX.PHP
	RewriteRule ^(.*)$ index.php?%{QUERY_STRING} [L]
</IfModule>
